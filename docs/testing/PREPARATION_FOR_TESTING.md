# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é

## üîß –ß—Ç–æ –Ω—É–∂–Ω–æ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å

### 1. –ù–∏—á–µ–≥–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ù–ï —Ç—Ä–µ–±—É–µ—Ç—Å—è! ‚úÖ

–•–æ—Ä–æ—à–∞—è –Ω–æ–≤–æ—Å—Ç—å: –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è Telegram –±–æ—Ç–∞ **–Ω–µ –Ω—É–∂–Ω–æ –Ω–∏—á–µ–≥–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö**. –í—Å–µ —Ç–µ—Å—Ç—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ —Å –º–æ–∫–∞–º–∏.

---

## üìã –ß—Ç–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è

### –õ–æ–∫–∞–ª—å–Ω—ã–µ –º–æ–∫–∏ (–±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤):

1. **Telegram Bot API** - –ø–æ–ª–Ω–æ—Å—Ç—å—é –º–æ–∫–∏—Ä—É–µ—Ç—Å—è
   - –ù–µ –Ω—É–∂–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–π —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
   - –ù–µ –Ω—É–∂–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–π Telegram –∞–∫–∫–∞—É–Ω—Ç
   - –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API –º–æ–∫–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `unittest.mock`

2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - —Ç–µ—Å—Ç–æ–≤–∞—è –ë–î
   - **–í–∞—Ä–∏–∞–Ω—Ç 1 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):** SQLite –≤ –ø–∞–º—è—Ç–∏
     - –ù–µ –Ω—É–∂–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
     - –ë—ã—Å—Ç—Ä–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
     - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç—Å—è
   - **–í–∞—Ä–∏–∞–Ω—Ç 2:** –û—Ç–¥–µ–ª—å–Ω–∞—è —Ç–µ—Å—Ç–æ–≤–∞—è PostgreSQL
     - –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω—É—é PostgreSQL
     - –ò–ª–∏ —Ç–µ—Å—Ç–æ–≤—É—é –ë–î –Ω–∞ Neon SQL (–µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ)

3. **–í—Å–µ –≤–Ω–µ—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** - –º–æ–∫–∏—Ä—É—é—Ç—Å—è
   - –ù–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è—Ö

---

## üéØ –ì–æ—Ç–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è Max Mode

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –≤–µ—Å—å —Ç–µ–∫—Å—Ç –∏–∑ —Ñ–∞–π–ª–∞ `MAX_MODE_TESTING_PROMPT.md` –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤ —Ä–µ–∂–∏–º Max Mode.

–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç –∫–æ—Ä–æ—Ç–∫–∏–π –ø—Ä–æ–º–ø—Ç:

---

## üìù –ö–†–ê–¢–ö–ò–ô –ü–†–û–ú–ü–¢ –î–õ–Ø MAX MODE

```
–°–æ–∑–¥–∞–π –ø–æ–ª–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è Telegram –±–æ—Ç–∞ "–ó–∞–≤—Ö–æ–∑".

–ó–ê–î–ê–ß–ê:
1. –î–æ–±–∞–≤–∏—Ç—å –≤ requirements.txt –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: pytest, pytest-asyncio, pytest-mock, pytest-cov, faker
2. –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–∞–ø–æ–∫ tests/ —Å unit/, integration/, e2e/ —Ç–µ—Å—Ç–∞–º–∏
3. –°–æ–∑–¥–∞—Ç—å conftest.py —Å fixtures –¥–ª—è –ë–î (SQLite –≤ –ø–∞–º—è—Ç–∏), –º–æ–∫–æ–≤ Telegram Bot, —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
4. –°–æ–∑–¥–∞—Ç—å pytest.ini –∏ .coveragerc –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
5. –ù–∞–ø–∏—Å–∞—Ç—å unit —Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (request_service, role_service, warehouse_service, complaint_service, notification_service)
6. –ù–∞–ø–∏—Å–∞—Ç—å unit —Ç–µ—Å—Ç—ã –¥–ª—è —É—Ç–∏–ª–∏—Ç (request_formatter, request_helpers)
7. –ù–∞–ø–∏—Å–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö handlers (start, request_creation, employee, warehouseman, manager)
8. –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã FSM —Å–æ—Å—Ç–æ—è–Ω–∏–π (request_creation_fsm, complaint_fsm)
9. –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã middleware (role_middleware)
10. –ù–∞–ø–∏—Å–∞—Ç—å —Ç–µ—Å—Ç—ã –ë–î (CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏, relationships)
11. –ù–∞–ø–∏—Å–∞—Ç—å end-to-end —Ç–µ—Å—Ç—ã –ø–æ–ª–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
12. –°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç—ã –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤ (run_tests.sh/bat)
13. –°–æ–∑–¥–∞—Ç—å TESTING_GUIDE.md —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏

–¢–†–ï–ë–û–í–ê–ù–ò–Ø:
- –í—Å–µ —Ç–µ—Å—Ç—ã –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å –æ—Ç–∫–∞—Ç–æ–º –¥–ª—è –ë–î)
- –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞ > 70%
- –í—Å–µ async —Ñ—É–Ω–∫—Ü–∏–∏ —Å @pytest.mark.asyncio
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å fixtures –¥–ª—è –æ–±—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –¢–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —É—Å–ø–µ—à–Ω–æ
- –ö–æ–¥ —Ç–µ—Å—Ç–æ–≤ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–º –∏ —á–∏—Ç–∞–µ–º—ã–º

–°–¢–†–£–ö–¢–£–†–ê:
tests/
‚îú‚îÄ‚îÄ conftest.py
‚îú‚îÄ‚îÄ unit/test_services/
‚îú‚îÄ‚îÄ unit/test_utils/
‚îú‚îÄ‚îÄ integration/test_handlers/
‚îú‚îÄ‚îÄ integration/test_fsm/
‚îú‚îÄ‚îÄ integration/test_middleware/
‚îú‚îÄ‚îÄ integration/test_database/
‚îî‚îÄ‚îÄ e2e/test_scenarios/

–í—Å–µ —Ç–µ—Å—Ç—ã –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ (–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏ docstrings).
```

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

### –ü–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –ø—Ä–æ–º–ø—Ç–∞ —É–±–µ–¥–∏—Ç–µ—Å—å:

- [x] –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–æ
- [x] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–∑ requirements.txt —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [x] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã (–¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
- [x] –ö–æ–¥ –±–æ—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç (–¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —á—Ç–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å)

### –ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–º–ø—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

- [ ] –í—Å–µ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã
- [ ] `pytest --collect-only` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ —Ç–µ—Å—Ç—ã
- [ ] `pytest tests/unit/` - unit —Ç–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è
- [ ] `pytest tests/integration/` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è
- [ ] `pytest --cov=bot --cov-report=html` - –ø–æ–∫—Ä—ã—Ç–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## üöÄ –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤

```powershell
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
pip install -r requirements.txt

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å–µ —Ç–µ—Å—Ç—ã –Ω–∞–π–¥–µ–Ω—ã
pytest --collect-only

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Ç–µ—Å—Ç—ã
pytest

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
pytest --cov=bot --cov-report=html

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ unit —Ç–µ—Å—Ç—ã
pytest tests/unit/

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
pytest tests/integration/

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ e2e —Ç–µ—Å—Ç—ã
pytest tests/e2e/

# –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ –≤ –∫–æ–Ω—Å–æ–ª–∏
pytest --cov=bot --cov-report=term-missing
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –∑–∞—Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—É—é —Ç–µ—Å—Ç–æ–≤—É—é –ë–î –≤–º–µ—Å—Ç–æ SQLite:

### Neon SQL (—Ç–µ—Å—Ç–æ–≤–∞—è –ë–î)
1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –ë–î –≤ Neon SQL —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
2. –î–æ–±–∞–≤–∏—Ç—å `TEST_DATABASE_URL` –≤ `.env`
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É –ë–î –≤ —Ç–µ—Å—Ç–∞—Ö

**–ù–æ —ç—Ç–æ –ù–ï –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ** - SQLite –≤ –ø–∞–º—è—Ç–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –æ—Ç–ª–∏—á–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤!

---

## üéØ –ò—Ç–æ–≥

**–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ù–ò–ß–ï–ì–û –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ!**

–í—Å–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ —Å –º–æ–∫–∞–º–∏. –ü—Ä–æ—Å—Ç–æ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–æ–º–ø—Ç –∏–∑ `MAX_MODE_TESTING_PROMPT.md` –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤ Max Mode.

