# ๐จ CREATIVE PHASE: FSM Master ะดะปั ัะพะทะดะฐะฝะธั ะทะฐัะฒะบะธ

## PROBLEM STATEMENT

ะะตะพะฑัะพะดะธะผะพ ัะฟัะพะตะบัะธัะพะฒะฐัั ัะดะพะฑะฝัะน ะธ ะธะฝััะธัะธะฒะฝัะน ะฟะพัะฐะณะพะฒัะน ะผะฐััะตั ัะพะทะดะฐะฝะธั ะทะฐัะฒะบะธ ะฒ Telegram ะฑะพัะต. ะะฐััะตั ะดะพะปะถะตะฝ:

1. ะัะพะฒะตััะธ ะฟะพะปัะทะพะฒะฐัะตะปั ัะตัะตะท 6 ัะฐะณะพะฒ (ะฝะตะบะพัะพััะต ััะปะพะฒะฝัะต)
2. ะกะพะฑัะฐัั ะฒัะต ะฝะตะพะฑัะพะดะธะผัะต ะดะฐะฝะฝัะต
3. ะะพะทะฒะพะปะธัั ะพัะผะตะฝะธัั ะฟัะพัะตัั ะฝะฐ ะปัะฑะพะผ ััะฐะฟะต
4. ะะฑัะฐะฑะพัะฐัั ะพัะธะฑะบะธ ะฒะฐะปะธะดะฐัะธะธ
5. ะะพะบะฐะทะฐัั ะฟัะตะดะฒะฐัะธัะตะปัะฝัะน ะฟัะพัะผะพัั ะฟะตัะตะด ัะพััะฐะฝะตะฝะธะตะผ
6. ะกะพััะฐะฝะธัั ัะพัะพ (ะดะพ 5 ัััะบ)

**ะัะทะพะฒั:**
- ะฃัะปะพะฒะฝัะน ัะฐะณ 3 (ะบะพะปะธัะตััะฒะพ) - ัะพะปัะบะพ ะดะปั ะฝะตะบะพัะพััั ะบะฐัะตะณะพัะธะน
- ะะพะทะผะพะถะฝะพััั ะทะฐะณััะทะบะธ ะฝะตัะบะพะปัะบะธั ัะพัะพ
- ะะฐะปะธะดะฐัะธั ะฝะฐ ะบะฐะถะดะพะผ ัะฐะณะต
- ะะพะทะผะพะถะฝะพััั ะพัะผะตะฝะธัั/ะฒะตัะฝััััั ะฝะฐะทะฐะด

---

## OPTIONS ANALYSIS

### Option 1: Linear FSM (ะะพัะปะตะดะพะฒะฐัะตะปัะฝัะน FSM)
**ะะพะดัะพะด:** ะกััะพะณะพ ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝัะต ัะพััะพัะฝะธั ะฑะตะท ะฒะพะทะฒัะฐัะฐ ะฝะฐะทะฐะด

**ะกัััะบัััะฐ:**
```
START โ CATEGORY โ DESCRIPTION โ QUANTITY? โ PRIORITY โ PHOTOS โ CONFIRM โ SAVE
```

**ะะปััั:**
- โ ะัะพััะฐั ัะตะฐะปะธะทะฐัะธั
- โ ะะตะณะบะพ ะฟะพะฝััั ะปะพะณะธะบั
- โ ะะตะฝััะต ัะพััะพัะฝะธะน

**ะะธะฝััั:**
- โ ะะตั ะฒะพะทะผะพะถะฝะพััะธ ะฒะตัะฝััััั ะธ ะธัะฟัะฐะฒะธัั
- โ ะะปะพัะพะน UX (ะตัะปะธ ะพัะธะฑะบะฐ - ะฝัะถะฝะพ ะฝะฐัะฐัั ะทะฐะฝะพะฒะพ)
- โ ะะตะณะธะฑะบะฐั ัะธััะตะผะฐ

**ะัะตะฝะบะฐ:** โญโญ (2/5) - ัะปะธัะบะพะผ ะฟัะพััะพะต ัะตัะตะฝะธะต

---

### Option 2: FSM with Back Navigation (FSM ั ะฒะพะทะผะพะถะฝะพัััั ะฒะตัะฝััััั)
**ะะพะดัะพะด:** ะะพัะปะตะดะพะฒะฐัะตะปัะฝัะต ัะพััะพัะฝะธั ั ะฒะพะทะผะพะถะฝะพัััั ะฒะพะทะฒัะฐัะฐ ะบ ะฟัะตะดัะดััะธะผ ัะฐะณะฐะผ

**ะกัััะบัััะฐ:**
```
START โ CATEGORY โ DESCRIPTION โ QUANTITY? โ PRIORITY โ PHOTOS โ CONFIRM โ SAVE
         โ_________________________________________________|
```

**ะะปััั:**
- โ ะฅะพัะพัะธะน UX (ะผะพะถะฝะพ ะธัะฟัะฐะฒะธัั ะพัะธะฑะบะธ)
- โ ะะธะฑะบะพััั ะดะปั ะฟะพะปัะทะพะฒะฐัะตะปั
- โ ะกัะฐะฝะดะฐััะฝัะน ะฟะพะดัะพะด ะดะปั ะผะฐััะตัะพะฒ

**ะะธะฝััั:**
- โ ะะพะปััะต ัะพััะพัะฝะธะน ะธ ะปะพะณะธะบะธ
- โ ะัะถะฝะพ ัะพััะฐะฝััั ะฟัะพะผะตะถััะพัะฝัะต ะดะฐะฝะฝัะต

**ะัะตะฝะบะฐ:** โญโญโญโญ (4/5) - ัะพัะพัะธะน ะฑะฐะปะฐะฝั

---

### Option 3: Wizard with Data Context (ะะฐััะตั ั ะบะพะฝัะตะบััะพะผ ะดะฐะฝะฝัั)
**ะะพะดัะพะด:** FSM ั ะพัะดะตะปัะฝัะผ ะพะฑัะตะบัะพะผ ะดะฐะฝะฝัั, ะบะพัะพััะน ัะพััะฐะฝัะตััั ะฝะฐ ะบะฐะถะดะพะผ ัะฐะณะต

**ะกัััะบัััะฐ:**
```
States: 
- WaitingForCategory
- WaitingForDescription
- WaitingForQuantity (optional)
- WaitingForPriority
- WaitingForPhotos
- WaitingForConfirmation

Data Context Object:
{
  category: str | None
  description: str | None
  quantity: int | None
  priority: str | None
  photos: List[str]
}
```

**ะะปััั:**
- โ ะะธะฑะบะพััั (ะผะพะถะฝะพ ะผะตะฝััั ะดะฐะฝะฝัะต)
- โ ะะพะทะผะพะถะฝะพััั ะพัะผะตะฝั ะฑะตะท ะฟะพัะตัะธ ะดะฐะฝะฝัั
- โ ะะตะณะบะพ ะดะพะฑะฐะฒะธัั ะฐะฒัะพัะพััะฐะฝะตะฝะธะต
- โ ะงะตัะบะพะต ัะฐะทะดะตะปะตะฝะธะต ัะพััะพัะฝะธะน ะธ ะดะฐะฝะฝัั

**ะะธะฝััั:**
- โ ะะตะผะฝะพะณะพ ัะปะพะถะฝะตะต ัะตะฐะปะธะทะฐัะธั
- โ ะัะถะฝะพ ัะฟัะฐะฒะปััั ะบะพะฝัะตะบััะพะผ

**ะัะตะฝะบะฐ:** โญโญโญโญโญ (5/5) - ะพะฟัะธะผะฐะปัะฝะพะต ัะตัะตะฝะธะต

---

### Option 4: Conversation-based (ะะฐะทะณะพะฒะพัะฝัะน ะฟะพะดัะพะด)
**ะะพะดัะพะด:** ะัะฟะพะปัะทะพะฒะฐะฝะธะต aiogram ConversationHandler ะฒะผะตััะพ FSM

**ะะปััั:**
- โ ะัััะพะตะฝะฝะฐั ะฟะพะดะดะตัะถะบะฐ ะฒ aiogram
- โ ะะฒัะพะผะฐัะธัะตัะบะพะต ัะฟัะฐะฒะปะตะฝะธะต ัะพััะพัะฝะธัะผะธ

**ะะธะฝััั:**
- โ ะะตะฝััะต ะบะพะฝััะพะปั ะฝะฐะด ะฟัะพัะตััะพะผ
- โ ะกะปะพะถะฝะตะต ะพะฑัะฐะฑะฐััะฒะฐัั ััะปะพะฒะฝัะต ัะฐะณะธ
- โ ะฃััะฐัะตะฒัะธะน ะฟะพะดัะพะด (ConversationHandler deprecated ะฒ aiogram 3.x)

**ะัะตะฝะบะฐ:** โญโญ (2/5) - ะฝะต ะฟะพะดัะพะดะธั ะดะปั aiogram 3.x

---

## DECISION

**ะัะฑัะฐะฝะฝัะน ะฟะพะดัะพะด:** **Option 3 - Wizard with Data Context**

### ะะฑะพัะฝะพะฒะฐะฝะธะต:

1. **ะะธะฑะบะพััั ะธ UX:** ะะพะปัะทะพะฒะฐัะตะปั ะผะพะถะตั ะธัะฟัะฐะฒะธัั ะปัะฑะพะน ัะฐะณ, ะฝะต ะฝะฐัะธะฝะฐั ะทะฐะฝะพะฒะพ
2. **ะกะพะฒัะตะผะตะฝะฝัะน ะฟะพะดัะพะด:** ะัะฟะพะปัะทัะตั FSMContext ะธะท aiogram 3.x
3. **ะะฐัััะฐะฑะธััะตะผะพััั:** ะะตะณะบะพ ะดะพะฑะฐะฒะธัั ะฝะพะฒัะต ัะฐะณะธ ะธะปะธ ะธะทะผะตะฝะธัั ะฟะพััะดะพะบ
4. **ะะฐะดะตะถะฝะพััั:** ะะฐะฝะฝัะต ััะฐะฝัััั ะฒ ะบะพะฝัะตะบััะต, ะฝะต ัะตัััััั ะฟัะธ ะพัะธะฑะบะฐั
5. **ะฃัะปะพะฒะฝะฐั ะปะพะณะธะบะฐ:** ะะตะณะบะพ ัะตะฐะปะธะทะพะฒะฐัั ะฟัะพะฟััะบ ัะฐะณะฐ ั ะบะพะปะธัะตััะฒะพะผ

---

## IMPLEMENTATION DESIGN

### State Machine Flow

```mermaid
graph TD
    Start([ะะพะปัะทะพะฒะฐัะตะปั: ะะพะฒะฐั ะทะฐัะฒะบะฐ]) --> Category[1. ะัะฑะพั ะบะฐัะตะณะพัะธะธ]
    
    Category -->|ะะฝะพะฟะบะฐ ะบะฐัะตะณะพัะธะธ| DescCheck{ะะฐัะตัะธะฐะป?}
    DescCheck -->|ะะฐ| Description[2. ะะฒะพะด ะพะฟะธัะฐะฝะธั]
    DescCheck -->|ะะตั| Description
    
    Description -->|ะขะตะบัั| QuantityCheck{ะะฐัะตะณะพัะธั<br>ะผะฐัะตัะธะฐะป?}
    QuantityCheck -->|ะะฐ| Quantity[3. ะะฒะพะด ะบะพะปะธัะตััะฒะฐ]
    QuantityCheck -->|ะะตั| Priority[4. ะัะฑะพั ะฟัะธะพัะธัะตัะฐ]
    
    Quantity -->|ะงะธัะปะพ| Priority
    
    Priority -->|ะะฑััะฝะฐั/ะกัะพัะฝะพ| Photos[5. ะะฐะณััะทะบะฐ ัะพัะพ]
    
    Photos -->|ะคะพัะพ 1-5 ะธะปะธ ะัะพะฟัััะธัั| Confirm[6. ะะพะดัะฒะตัะถะดะตะฝะธะต]
    
    Confirm -->|ะะทะผะตะฝะธัั| EditMenu[ะะตะฝั ัะตะดะฐะบัะธัะพะฒะฐะฝะธั]
    Confirm -->|ะัะผะตะฝะธัั| Cancel[ะัะผะตะฝะฐ ัะพะทะดะฐะฝะธั]
    Confirm -->|ะกะพะทะดะฐัั| Save[ะกะพััะฐะฝะตะฝะธะต ะทะฐัะฒะบะธ]
    
    EditMenu -->|ะะฐัะตะณะพัะธั| Category
    EditMenu -->|ะะฟะธัะฐะฝะธะต| Description
    EditMenu -->|ะะพะปะธัะตััะฒะพ| Quantity
    EditMenu -->|ะัะธะพัะธัะตั| Priority
    EditMenu -->|ะคะพัะพ| Photos
    
    Cancel --> End1([ะะฐัะฒะบะฐ ะพัะผะตะฝะตะฝะฐ])
    Save --> End2([ะะฐัะฒะบะฐ ัะพะทะดะฐะฝะฐ])
```

### FSM States Definition

```python
from aiogram.fsm.state import State, StatesGroup

class RequestCreationStates(StatesGroup):
    """ะกะพััะพัะฝะธั ะดะปั ัะพะทะดะฐะฝะธั ะทะฐัะฒะบะธ"""
    waiting_for_category = State()      # ะจะฐะณ 1: ะัะฑะพั ะบะฐัะตะณะพัะธะธ
    waiting_for_description = State()   # ะจะฐะณ 2: ะะฒะพะด ะพะฟะธัะฐะฝะธั
    waiting_for_quantity = State()      # ะจะฐะณ 3: ะะฒะพะด ะบะพะปะธัะตััะฒะฐ (ััะปะพะฒะฝะพ)
    waiting_for_priority = State()      # ะจะฐะณ 4: ะัะฑะพั ะฟัะธะพัะธัะตัะฐ
    waiting_for_photos = State()        # ะจะฐะณ 5: ะะฐะณััะทะบะฐ ัะพัะพ
    waiting_for_confirmation = State()  # ะจะฐะณ 6: ะะพะดัะฒะตัะถะดะตะฝะธะต
```

### Data Context Structure

```python
from dataclasses import dataclass, field
from typing import List, Optional

@dataclass
class RequestCreationData:
    """ะะฐะฝะฝัะต ัะพะทะดะฐะฒะฐะตะผะพะน ะทะฐัะฒะบะธ"""
    category: Optional[str] = None
    description: Optional[str] = None
    quantity: Optional[int] = None
    priority: Optional[str] = None  # 'normal' or 'urgent'
    photos: List[str] = field(default_factory=list)  # Telegram file_id
    
    def is_material_category(self) -> bool:
        """ะัะพะฒะตัะบะฐ, ัะฒะปัะตััั ะปะธ ะบะฐัะตะณะพัะธั ะผะฐัะตัะธะฐะปะพะผ"""
        material_categories = [
            "ะะฐะฝัะตะปััะธั",
            "ะงะฐะน, ะบะพัะต, ัะฐัะฐั, ะฒะพะดะฐ",
            "ะฅะพะทัะพะฒะฐัั ะธ ัะฑะพัะบะฐ",
            "ะะข-ะพะฑะพััะดะพะฒะฐะฝะธะต ะธ ัะฐััะพะดะฝะธะบะธ"
        ]
        return self.category in material_categories
    
    def is_complete(self) -> bool:
        """ะัะพะฒะตัะบะฐ ะฟะพะปะฝะพัั ะดะฐะฝะฝัั"""
        required = [
            self.category,
            self.description,
            self.priority
        ]
        
        # ะัะปะธ ะบะฐัะตะณะพัะธั - ะผะฐัะตัะธะฐะป, ัะพ ะบะพะปะธัะตััะฒะพ ะพะฑัะทะฐัะตะปัะฝะพ
        if self.is_material_category() and not self.quantity:
            return False
            
        return all(required)
    
    def to_preview_text(self) -> str:
        """ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต ะดะปั ะฟัะตะดะฟัะพัะผะพััะฐ"""
        text = f"๐ <b>ะัะตะดะฟัะพัะผะพัั ะทะฐัะฒะบะธ</b>\n\n"
        text += f"๐ <b>ะะฐัะตะณะพัะธั:</b> {self.category}\n"
        text += f"๐ <b>ะะฟะธัะฐะฝะธะต:</b> {self.description}\n"
        
        if self.quantity:
            text += f"๐ข <b>ะะพะปะธัะตััะฒะพ:</b> {self.quantity} ัั.\n"
            
        priority_emoji = "๐จ" if self.priority == "urgent" else "โฐ"
        priority_text = "ะกัะพัะฝะพ" if self.priority == "urgent" else "ะะฑััะฝะฐั"
        text += f"{priority_emoji} <b>ะัะธะพัะธัะตั:</b> {priority_text}\n"
        
        if self.photos:
            text += f"๐ท <b>ะคะพัะพ:</b> {len(self.photos)} ัั.\n"
            
        return text
```

### Handler Flow Implementation

```python
from aiogram.fsm.context import FSMContext
from aiogram.types import Message, CallbackQuery

# ะจะฐะณ 1: ะัะฑะพั ะบะฐัะตะณะพัะธะธ
@router.message(F.text == "ะะพะฒะฐั ะทะฐัะฒะบะฐ")
async def start_request_creation(message: Message, state: FSMContext):
    """ะะฐัะฐะปะพ ัะพะทะดะฐะฝะธั ะทะฐัะฒะบะธ"""
    await state.set_state(RequestCreationStates.waiting_for_category)
    await state.update_data(RequestCreationData())
    
    keyboard = create_category_keyboard()
    await message.answer(
        "๐ ะัะฑะตัะธัะต ะบะฐัะตะณะพัะธั ะทะฐัะฒะบะธ:",
        reply_markup=keyboard
    )

# ะจะฐะณ 2: ะะฒะพะด ะพะฟะธัะฐะฝะธั (ะฟะพัะปะต ะฒัะฑะพัะฐ ะบะฐัะตะณะพัะธะธ)
@router.callback_query(RequestCreationStates.waiting_for_category)
async def process_category(callback: CallbackQuery, state: FSMContext):
    category = callback.data
    await state.update_data(category=category)
    
    await state.set_state(RequestCreationStates.waiting_for_description)
    await callback.message.answer(
        f"โ ะะฐัะตะณะพัะธั: <b>{category}</b>\n\n"
        "๐ ะะฟะธัะธัะต, ััะพ ะฝัะถะฝะพ ะธะปะธ ะบะฐะบะฐั ะฟัะพะฑะปะตะผะฐ:"
    )
    await callback.answer()

# ะจะฐะณ 3: ะะฒะพะด ะบะพะปะธัะตััะฒะฐ (ััะปะพะฒะฝะพ)
@router.message(RequestCreationStates.waiting_for_description)
async def process_description(message: Message, state: FSMContext):
    description = message.text
    data = await state.get_data()
    data['description'] = description
    
    # ะัะพะฒะตัะบะฐ, ะฝัะถะตะฝ ะปะธ ัะฐะณ ั ะบะพะปะธัะตััะฒะพะผ
    if data.get('is_material_category'):
        await state.set_state(RequestCreationStates.waiting_for_quantity)
        await message.answer("๐ข ะฃะบะฐะถะธัะต ะบะพะปะธัะตััะฒะพ:")
    else:
        # ะัะพะฟััะบะฐะตะผ ัะฐะณ ั ะบะพะปะธัะตััะฒะพะผ
        await state.set_state(RequestCreationStates.waiting_for_priority)
        await show_priority_keyboard(message)

# ... (ะฟัะพะดะพะปะถะตะฝะธะต ะดะปั ะพััะฐะปัะฝัั ัะฐะณะพะฒ)
```

### Key Design Decisions

#### 1. **ะฃัะปะพะฒะฝัะน ัะฐะณ ั ะบะพะปะธัะตััะฒะพะผ**
- ะัะฟะพะปัะทัะตะผ ะฟัะพะฒะตัะบั `is_material_category()` ะฒ data context
- ะะฒัะพะผะฐัะธัะตัะบะธ ะฟัะพะฟััะบะฐะตะผ ัะฐะณ ะดะปั ะฝะตะผะฐัะตัะธะฐะปัะฝัั ะบะฐัะตะณะพัะธะน

#### 2. **ะะฐะณััะทะบะฐ ัะพัะพ**
- ะะฐะบัะธะผัะผ 5 ัะพัะพ
- ะะพะปัะทะพะฒะฐัะตะปั ะผะพะถะตั ะฟัะพะฟัััะธัั ััะพั ัะฐะณ
- ะกะพััะฐะฝัะตะผ ัะพะปัะบะพ `file_id` ะพั Telegram (ะดะปั MVP)
- ะะพะดััะตั ัะพัะพ: "ะคะพัะพ 1/5, ะพัะฟัะฐะฒััะต ัะปะตะดัััะตะต ะธะปะธ ะฝะฐะถะผะธัะต 'ะัะพะฟัััะธัั'"

#### 3. **ะะตะดะฐะบัะธัะพะฒะฐะฝะธะต ะฝะฐ ััะฐะฟะต ะฟะพะดัะฒะตัะถะดะตะฝะธั**
- ะะฝะพะฟะบะฐ "ะะทะผะตะฝะธัั" ะพัะบััะฒะฐะตั ะผะตะฝั ะฒัะฑะพัะฐ ะฟะพะปั
- ะะพะทะฒัะฐั ะบ ะฝัะถะฝะพะผั ัะฐะณั ะฑะตะท ะฟะพัะตัะธ ะดะฐะฝะฝัั
- ะัะต ะพััะฐะปัะฝัะต ะดะฐะฝะฝัะต ัะพััะฐะฝััััั ะฒ ะบะพะฝัะตะบััะต

#### 4. **ะะฐะปะธะดะฐัะธั**
- ะัะพะฒะตัะบะฐ ะฝะฐ ะบะฐะถะดะพะผ ัะฐะณะต
- ะะพะฝััะฝัะต ัะพะพะฑัะตะฝะธั ะพะฑ ะพัะธะฑะบะฐั
- ะะพะทะผะพะถะฝะพััั ะธัะฟัะฐะฒะธัั ะพัะธะฑะบั ะฑะตะท ะฟะตัะตะทะฐะฟััะบะฐ

#### 5. **ะัะผะตะฝะฐ**
- ะะฝะพะฟะบะฐ "ะัะผะตะฝะธัั" ะฝะฐ ะปัะฑะพะผ ััะฐะฟะต
- ะัะธััะบะฐ ัะพััะพัะฝะธั FSM
- ะะพะทะฒัะฐั ะฒ ะณะปะฐะฒะฝะพะต ะผะตะฝั

---

## VISUAL FLOW DIAGRAM

### Complete User Journey

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ะะพะปัะทะพะฒะฐัะตะปั ะฝะฐะถะธะผะฐะตั "ะะพะฒะฐั ะทะฐัะฒะบะฐ"   โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
               โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ะจะฐะณ 1: ะะพะบะฐะทัะฒะฐะตะผ 9 ะบะฐัะตะณะพัะธะน ะบะฝะพะฟะบะฐะผะธ โ
โ  โโโโโโโ โโโโโโโ โโโโโโโ               โ
โ  โะะฐะฝั โ โะงะฐะน  โ โะฅะพะท  โ ...            โ
โ  โโโโโโโ โโโโโโโ โโโโโโโ               โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
               โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ะจะฐะณ 2: ะะฐะฟัะฐัะธะฒะฐะตะผ ัะตะบััะพะฒะพะต ะพะฟะธัะฐะฝะธะต  โ
โ  "ะะฟะธัะธัะต, ััะพ ะฝัะถะฝะพ..."                โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
               โผ
        โโโโโโโโดโโโโโโโ
        โ ะะฐัะตัะธะฐะป?   โ
        โโโโฌโโโโโโโฌโโโโ
          ะะฐโ      โะะตั
            โ      โ
    โโโโโโโโโ      โโโโโโโโโ
    โผ                      โผ
โโโโโโโโโโโ         โโโโโโโโโโโโโโโ
โ ะจะฐะณ 3:  โ         โ ะัะพะฟััะบะฐะตะผ  โ
โะะพะปะธัะตััะฒะพโ         โ ะบ ะจะฐะณั 4   โ
โโโโโโฌโโโโโ         โโโโโโโโฌโโโโโโโ
     โ                     โ
     โโโโโโโโโโโโฌโโโโโโโโโโโ
                โ
                โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ะจะฐะณ 4: ะัะฑะพั ะฟัะธะพัะธัะตัะฐ                โ
โ  [ะะฑััะฝะฐั] [๐จ ะกัะพัะฝะพ]                  โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
               โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ะจะฐะณ 5: ะะฐะณััะทะบะฐ ัะพัะพ (ะดะพ 5 ัั)         โ
โ  "ะัะฟัะฐะฒััะต ัะพัะพ ะธะปะธ ะฝะฐะถะผะธัะต ะัะพะฟัััะธัั"โ
โ  ะกัะตััะธะบ: ะคะพัะพ 1/5                      โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
               โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ะจะฐะณ 6: ะะพะดัะฒะตัะถะดะตะฝะธะต                   โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ        โ
โ  โ ๐ ะัะตะดะฟัะพัะผะพัั ะทะฐัะฒะบะธ      โ        โ
โ  โ ะะฐัะตะณะพัะธั: ะะฐะฝัะตะปััะธั       โ        โ
โ  โ ะะฟะธัะฐะฝะธะต: ะัะถะฝั ัััะบะธ       โ        โ
โ  โ ะะพะปะธัะตััะฒะพ: 10 ัั.          โ        โ
โ  โ ะัะธะพัะธัะตั: ะะฑััะฝะฐั          โ        โ
โ  โ ะคะพัะพ: 2 ัั.                 โ        โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ        โ
โ  [โ ะกะพะทะดะฐัั] [โ๏ธ ะะทะผะตะฝะธัั] [โ ะัะผะตะฝะธัั]โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโ
               โ
        โโโโโโโโดโโโโโโโ
        โ ะะตะนััะฒะธะต    โ
        โโโโฌโโโโโโโฌโโโโ
    ะกะพะทะดะฐััโ      โะัะผะตะฝะธัั
           โ      โ
    โโโโโโโโ      โโโโโโโโ
    โผ                     โผ
โโโโโโโโโโโ         โโโโโโโโโโโ
โ ะกะพััะฐะฝะธััโ        โ ะัะธััะธััโ
โ ะฒ ะะ    โ         โ FSM     โ
โโโโโโฌโโโโโ         โโโโโโฌโโโโโ
     โ                   โ
     โผ                   โผ
โโโโโโโโโโโ         โโโโโโโโโโโ
โ ะะฐัะฒะบะฐ  โ         โ ะะพะทะฒัะฐั โ
โ ัะพะทะดะฐะฝะฐ โ         โ ะฒ ะผะตะฝั  โ
โโโโโโโโโโโ         โโโโโโโโโโโ
```

---

## ERROR HANDLING

### Validation Errors

1. **ะัััะพะต ะพะฟะธัะฐะฝะธะต:**
   ```
   โ ะะฟะธัะฐะฝะธะต ะฝะต ะผะพะถะตั ะฑััั ะฟััััะผ. ะะพะถะฐะปัะนััะฐ, ะพะฟะธัะธัะต ะฟัะพะฑะปะตะผั:
   ```

2. **ะะตะบะพััะตะบัะฝะพะต ะบะพะปะธัะตััะฒะพ:**
   ```
   โ ะะพะถะฐะปัะนััะฐ, ัะบะฐะถะธัะต ะบะพััะตะบัะฝะพะต ัะธัะปะพ (ะฝะฐะฟัะธะผะตั: 10)
   ```

3. **ะกะปะธัะบะพะผ ะผะฝะพะณะพ ัะพัะพ:**
   ```
   โ ะะพะถะฝะพ ะทะฐะณััะทะธัั ะผะฐะบัะธะผัะผ 5 ัะพัะพ. ะั ัะถะต ะทะฐะณััะทะธะปะธ 5 ัะพัะพ.
   [ะะตัะตะนัะธ ะบ ะฟะพะดัะฒะตัะถะดะตะฝะธั]
   ```

4. **ะะตะบะพััะตะบัะฝัะน ัะธะฟ ัะฐะนะปะฐ:**
   ```
   โ ะะพะถะฐะปัะนััะฐ, ะพัะฟัะฐะฒััะต ัะพัะพ (ะธะทะพะฑัะฐะถะตะฝะธะต), ะฐ ะฝะต ัะฐะนะป
   ```

### Edge Cases

1. **ะะพะปัะทะพะฒะฐัะตะปั ะพัะฟัะฐะฒะปัะตั ะบะพะผะฐะฝะดั ะฒะพ ะฒัะตะผั ัะพะทะดะฐะฝะธั:**
   - ะกะพััะฐะฝัะตะผ ัะตะบััะตะต ัะพััะพัะฝะธะต
   - ะะฑัะฐะฑะฐััะฒะฐะตะผ ะบะพะผะฐะฝะดั
   - ะะพะทะฒัะฐัะฐะตะผัั ะบ ัะตะบััะตะผั ัะฐะณั

2. **ะขะฐะนะผะฐัั FSM (ะฟะพะปัะทะพะฒะฐัะตะปั ะดะพะปะณะพ ะฝะต ะพัะฒะตัะฐะตั):**
   - ะะพัะปะต 30 ะผะธะฝัั ะฑะตะทะดะตะนััะฒะธั ะพัะธัะฐะตะผ ัะพััะพัะฝะธะต
   - ะฃะฒะตะดะพะผะปัะตะผ ะฟะพะปัะทะพะฒะฐัะตะปั ะฟัะธ ัะปะตะดัััะตะผ ัะพะพะฑัะตะฝะธะธ

3. **ะัะธะฑะบะฐ ัะพััะฐะฝะตะฝะธั ะฒ ะะ:**
   - ะกะพััะฐะฝัะตะผ ะดะฐะฝะฝัะต ะฒ ะบะพะฝัะตะบััะต
   - ะะพะบะฐะทัะฒะฐะตะผ ะพัะธะฑะบั
   - ะัะตะดะปะฐะณะฐะตะผ ะฟะพะฒัะพัะธัั

---

## IMPLEMENTATION CHECKLIST

- [ ] ะกะพะทะดะฐัั RequestCreationStates (FSM ัะพััะพัะฝะธั)
- [ ] ะกะพะทะดะฐัั RequestCreationData (dataclass ะดะปั ะดะฐะฝะฝัั)
- [ ] ะะตะฐะปะธะทะพะฒะฐัั ะพะฑัะฐะฑะพััะธะบ ะฝะฐัะฐะปะฐ ัะพะทะดะฐะฝะธั ะทะฐัะฒะบะธ
- [ ] ะะตะฐะปะธะทะพะฒะฐัั ะพะฑัะฐะฑะพััะธะบ ะฒัะฑะพัะฐ ะบะฐัะตะณะพัะธะธ
- [ ] ะะตะฐะปะธะทะพะฒะฐัั ะพะฑัะฐะฑะพััะธะบ ะฒะฒะพะดะฐ ะพะฟะธัะฐะฝะธั
- [ ] ะะตะฐะปะธะทะพะฒะฐัั ััะปะพะฒะฝัั ะปะพะณะธะบั ะดะปั ะบะพะปะธัะตััะฒะฐ
- [ ] ะะตะฐะปะธะทะพะฒะฐัั ะพะฑัะฐะฑะพััะธะบ ะฒัะฑะพัะฐ ะฟัะธะพัะธัะตัะฐ
- [ ] ะะตะฐะปะธะทะพะฒะฐัั ะพะฑัะฐะฑะพััะธะบ ะทะฐะณััะทะบะธ ัะพัะพ (ะดะพ 5 ัั)
- [ ] ะะตะฐะปะธะทะพะฒะฐัั ัะบัะฐะฝ ะฟะพะดัะฒะตัะถะดะตะฝะธั ั ะฟัะตะดะฟัะพัะผะพััะพะผ
- [ ] ะะตะฐะปะธะทะพะฒะฐัั ะผะตะฝั ัะตะดะฐะบัะธัะพะฒะฐะฝะธั
- [ ] ะะตะฐะปะธะทะพะฒะฐัั ัะพััะฐะฝะตะฝะธะต ะทะฐัะฒะบะธ ะฒ ะะ
- [ ] ะะตะฐะปะธะทะพะฒะฐัั ะฒะฐะปะธะดะฐัะธั ะฝะฐ ะบะฐะถะดะพะผ ัะฐะณะต
- [ ] ะะตะฐะปะธะทะพะฒะฐัั ะพะฑัะฐะฑะพัะบั ะพัะธะฑะพะบ
- [ ] ะะตะฐะปะธะทะพะฒะฐัั ะพัะผะตะฝั ัะพะทะดะฐะฝะธั
- [ ] ะะพะฑะฐะฒะธัั ัะฐะนะผะฐััั ะธ ะพัะธััะบั ัะพััะพัะฝะธั

---

## NEXT STEPS

ะะพัะปะต ะฟัะพะตะบัะธัะพะฒะฐะฝะธั FSM ะผะฐััะตัะฐ:

1. ะกะพะทะดะฐัั ะฐะฝะฐะปะพะณะธัะฝัะน ะดะธะทะฐะนะฝ ะดะปั ะผะฐััะตัะฐ ัะพะทะดะฐะฝะธั ะถะฐะปะพะฑั
2. ะกะฟัะพะตะบัะธัะพะฒะฐัั UI/UX ะดะปั ะดััะณะธั ััะฝะบัะธะน
3. ะะตัะตะนัะธ ะบ ัะตะฐะปะธะทะฐัะธะธ ะฟะพัะปะต ััะฒะตัะถะดะตะฝะธั ะดะธะทะฐะนะฝะฐ

---

**ะกัะฐััั:** โ ะะธะทะฐะนะฝ ะทะฐะฒะตััะตะฝ
**ะกะปะตะดัััะธะน ัะฐะณ:** ะะตะฐะปะธะทะฐัะธั ะฒ IMPLEMENT ัะตะถะธะผะต

